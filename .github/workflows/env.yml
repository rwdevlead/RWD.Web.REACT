name: Environment Setup
on:
  workflow_call:
    outputs:
      env_json:
        description: "Environment variables as JSON"
        value: ${{ jobs.load_env.outputs.env_json }}

jobs:
  load_env:
    runs-on: ubuntu-latest
    outputs:
      env_json: ${{ steps.set_env.outputs.env_json }}
    steps:
      - id: set_env
        run: |
          ENV_JSON=$(cat << EOF
          {
            "NODE_VERSION": "20",
            "VERCEL_ORG_ID": "${{ secrets.VERCEL_ORG_ID }}",
            "VERCEL_PROJECT_ID": "${{ secrets.VERCEL_PROJECT_ID }}",
            "VERCEL_TOKEN": "${{ secrets.VERCEL_TOKEN }}",
            "SLACK_WEBHOOK_URL": "${{ secrets.SLACK_WEBHOOK_URL }}"
          }
          EOF
          )
          echo "env_json=$ENV_JSON" >> $GITHUB_OUTPUT
